!function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){function n(e){if("object"==typeof e)return e;for(var t=e.match(/([+\-0-9eE\.]+)/g),r=[],n={},i=0,s=t?t.length:0;i<s;i+=3)n=new THREE.Vector3(+t[i+0],+t[i+1],+t[i+2]),r.push(n);return r}function i(e){if("object"==typeof e)return e;for(var t=e.match(/([+\-0-9eE\.]+)/g),r=[],n={},i=0,s=t?t.length:0;i<s;i+=3)n=new THREE.Face3(+t[i+0],+t[i+1],+t[i+2]),r.push(n);return r}function s(e){if("object"==typeof e)return e;for(var t=e.match(/([+\-0-9eE\.]+)/g),r=[],n={},i=0,s=t?t.length:0;i<s;i+=2)n=new THREE.Vector2(+t[i+0],+t[i+1]),r.push(n);return r}function a(e,t){e.vertices.forEach(function(r,n){var i=t.vertices[n];e.vertices[n].set(i.x,i.y,i.z)}),e.computeBoundingBox()}function o(e,t,r){var n=new THREE.Geometry;if(n.vertices=e.vertices,n.computeBoundingBox(),0==e.triangles.length){for(var i=u(n),s=c(e,i),a=t.x[s],o=t.y[s],f=e.vertices.map(function(e){return[e[a]+0,e[o]+0]}),l=h.triangulate(f),p=0;p<l.length;p+=3)n.faces.push(new THREE.Face3(l[p],l[p+1],l[p+2]));return n}return n.faces=e.triangles,n}function u(e){var t=e.boundingBox,r=t.max.clone();return r.sub(t.min),r}function c(e,t){var r=e.projectdir.toLowerCase();return"x"!==r&&"y"!==r&&"z"!==r&&(r="z",t.x<t.y&&t.x<t.z&&(r="x"),t.y<t.x&&t.y<t.z&&(r="y")),r}function f(e,t,r){var n=e.uvs;if(n.length>0){for(var i=+n.length,s=i;s<t.vertices.length;s++)n.push(n[i].clone);return n}var a=u(t),o=c(e,a),f=r.x[o],l=r.y[o],h=t.vertices,p=t.boundingBox,g=p.min[f],v=p.min[l],m=[];return h.forEach(function(e){m.push(new THREE.Vector2((e[f]-g)/a[f],(e[l]-v)/a[l]))}),m}function l(e,t,r){var n=helperMatrix.makeTranslation(t.x-r.x,t.y-r.y,t.z-r.z);e.applyMatrix(n),e.verticesNeedsUpdate=!0}if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");var h=r(1);AFRAME.registerComponent("faceset",{schema:{vertices:{default:[{x:-.5,y:0,z:.5},{x:.5,y:0,z:.5},{x:.5,y:0,z:-.5},{x:-.5,y:0,z:-.5}],parse:function(e){return n(e)},stringify:function(e){return e.map(AFRAME.utils.coordinates.stringify).join(",")}},triangles:{default:[],parse:function(e){return i(e)},stringify:function(e){return e.map(function(e){return{x:e.a,y:e.b,z:e.c}}).map(AFRAME.utils.coordinates.stringify).join(",")}},uvs:{default:[],parse:function(e){return s(e)},stringify:function(e){return e.map(function(e){return"object"!=typeof e?e:[e.x,e.y].join(" ")}).join(",")}},projectdir:{type:"string",default:"auto"},translate:{type:"vec3"}},init:function(){this.dmaps={x:{x:"y",y:"x",z:"x"},y:{x:"z",y:"z",z:"y"}};var e=this.el.getOrCreateObject3D("mesh",THREE.Mesh);e.geometry.dispose(),e.geometry=null,e.geometry=new THREE.Geometry},update:function(e){e=e||{};var t=this.data,r=e.translate||this.schema.translate.default,n=AFRAME.utils.diff(e,t),i=this.el.getOrCreateObject3D("mesh",THREE.Mesh),s=i.geometry,u=!(1===Object.keys(n).length&&("translate"in n||"uvs"in n)),c=t.vertices.length==s.vertices.length&&t.triangles.length==s.faces.length,h=!AFRAME.utils.deepEqual(t.translate,r),p=!0,p=t.vertices.length!==s.vertices.length||t.triangles.length!==s.faces.length,g="uvs"in n||p;if(u)if(c)a(s,this.data);else{i.geometry.dispose(),i.geometry=null;var v=i.material;s=o(this.data,this.dmaps,p),i=new THREE.Mesh(s,v),this.el.setObject3D("mesh",i)}if(h&&l(s,t.translate,r),g){s.faceVertexUvs[0]=[];var m=s.faces,y=f(t,s,this.dmaps);m.forEach(function(e,t){s.faceVertexUvs[0].push([y[e.a],y[e.b],y[e.c]])}),s.uvsNeedUpdate=!0}s.mergeVertices(),s.computeFaceNormals(),s.computeVertexNormals(),s.verticesNeedUpdate=!0},remove:function(){this.el.getObject3D("mesh").geometry.dispose(),this.el.getObject3D("mesh").geometry=new THREE.Geometry}});var p=AFRAME.utils.extendDeep,g=AFRAME.primitives.getMeshMixin();AFRAME.registerPrimitive("a-faceset",p({},g,{defaultComponents:{faceset:{}},mappings:{vertices:"faceset.vertices",triangles:"faceset.triangles",uvs:"faceset.uvs",projectdir:"faceset.projectdir"}}))},function(e,t,r){var n;!function(){"use strict";function t(e){var t,r,n,i,s,a,o=Number.POSITIVE_INFINITY,u=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,f=Number.NEGATIVE_INFINITY;for(t=e.length;t--;)e[t][0]<o&&(o=e[t][0]),e[t][0]>c&&(c=e[t][0]),e[t][1]<u&&(u=e[t][1]),e[t][1]>f&&(f=e[t][1]);return r=c-o,n=f-u,i=Math.max(r,n),s=o+.5*r,a=u+.5*n,[[s-20*i,a-i],[s,a+20*i],[s+20*i,a-i]]}function r(e,t,r,n){var i,a,o,u,c,f,l,h,p,g,v=e[t][0],m=e[t][1],y=e[r][0],E=e[r][1],d=e[n][0],x=e[n][1],b=Math.abs(m-E),j=Math.abs(E-x);if(b<s&&j<s)throw new Error("Eek! Coincident points!");return b<s?(u=-((d-y)/(x-E)),f=(y+d)/2,h=(E+x)/2,i=(y+v)/2,a=u*(i-f)+h):j<s?(o=-((y-v)/(E-m)),c=(v+y)/2,l=(m+E)/2,i=(d+y)/2,a=o*(i-c)+l):(o=-((y-v)/(E-m)),u=-((d-y)/(x-E)),c=(v+y)/2,f=(y+d)/2,l=(m+E)/2,h=(E+x)/2,i=(o*c-u*f+h-l)/(o-u),a=b>j?o*(i-c)+l:u*(i-f)+h),p=y-i,g=E-a,{i:t,j:r,k:n,x:i,y:a,r:p*p+g*g}}function i(e){var t,r,n,i,s,a;for(r=e.length;r;)for(i=e[--r],n=e[--r],t=r;t;)if(a=e[--t],s=e[--t],n===s&&i===a||n===a&&i===s){e.splice(r,2),e.splice(t,2);break}}var s=1/1048576;n={triangulate:function(e,n){var a,o,u,c,f,l,h,p,g,v,m,y,E=e.length;if(E<3)return[];if(e=e.slice(0),n)for(a=E;a--;)e[a]=e[a][n];for(u=new Array(E),a=E;a--;)u[a]=a;for(u.sort(function(t,r){return e[r][0]-e[t][0]}),c=t(e),e.push(c[0],c[1],c[2]),f=[r(e,E+0,E+1,E+2)],l=[],h=[],a=u.length;a--;h.length=0){for(y=u[a],o=f.length;o--;)p=e[y][0]-f[o].x,p>0&&p*p>f[o].r?(l.push(f[o]),f.splice(o,1)):(g=e[y][1]-f[o].y,p*p+g*g-f[o].r>s||(h.push(f[o].i,f[o].j,f[o].j,f[o].k,f[o].k,f[o].i),f.splice(o,1)));for(i(h),o=h.length;o;)m=h[--o],v=h[--o],f.push(r(e,v,m,y))}for(a=f.length;a--;)l.push(f[a]);for(f.length=0,a=l.length;a--;)l[a].i<E&&l[a].j<E&&l[a].k<E&&f.push(l[a].i,l[a].j,l[a].k);return f},contains:function(e,t){if(t[0]<e[0][0]&&t[0]<e[1][0]&&t[0]<e[2][0]||t[0]>e[0][0]&&t[0]>e[1][0]&&t[0]>e[2][0]||t[1]<e[0][1]&&t[1]<e[1][1]&&t[1]<e[2][1]||t[1]>e[0][1]&&t[1]>e[1][1]&&t[1]>e[2][1])return null;var r=e[1][0]-e[0][0],n=e[2][0]-e[0][0],i=e[1][1]-e[0][1],s=e[2][1]-e[0][1],a=r*s-n*i;if(0===a)return null;var o=(s*(t[0]-e[0][0])-n*(t[1]-e[0][1]))/a,u=(r*(t[1]-e[0][1])-i*(t[0]-e[0][0]))/a;return o<0||u<0||o+u>1?null:[o,u]}},e.exports=n}()}]);